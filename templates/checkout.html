{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Vest Lavichy ‚Ä¢ Pagamento</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    <link rel="stylesheet" href="{% static 'css/checkout.css' %}">

</head>

<body>

<header class="checkout-header shadow-sm bg-white position-relative">
    <div class="container d-flex align-items-center justify-content-between py-3">

        <div class="d-flex align-items-center">
            <button class="btn d-md-none me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#menuMobile">
                ‚ò∞
            </button>
            <a href="{% url 'index' %}" class="logo">
                <img src="{% static 'img/icones_categorias/VestLavichy.png' %}" alt="Logo" style="max-height: 45px;">
            </a>
        </div>

        <div class="position-absolute top-50 start-50 translate-middle d-none d-md-block">
            <span class="brand-center">Vest Lavichy</span>
        </div>

        <div class="header-icons d-flex gap-3 align-items-center">
            {% if user.is_authenticated %}
                <span class="small text-muted d-none d-sm-inline">Ol√°, {{ user.username }}</span>
                <a href="{% url 'logout' %}" class="text-decoration-none text-dark small">Sair</a>
            {% else %}
                <a href="/login" class="text-decoration-none text-dark small">Entrar</a>
            {% endif %}
            <a href="{% url 'meus_pedidos' %}" class="text-decoration-none text-dark small">
            Meus Pedidos
            </a>
        </div>
    </div>
</header>

<div class="offcanvas offcanvas-start" tabindex="-1" id="menuMobile">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        {% if user.is_authenticated %}
            <p class="fw-bold mb-2">Ol√°, {{ user.username }} üëã</p>
            <a href="{% url 'logout' %}" class="menu-item d-block mb-3 text-danger">Sair</a>
        {% else %}
            <a href="/login" class="menu-item d-block mb-3 fw-bold">Entrar / Cadastrar</a>
        {% endif %}
        <a href="{% url 'meus_pedidos' %}" class="menu-item d-block mb-2 text-decoration-none text-dark">
            üì¶ Meus Pedidos
        </a>
    </div>
</div>

<div class="container my-5 checkout-page" style="min-height: 70vh;">
<br>
    <div class="row">
        <div class="col-lg-8">
            <div class="checkout-card mb-4 border-0">
                <h5>üìç Endere√ßo de Entrega</h5>
                <hr>
                <p class="text-muted mb-0">
                    <strong>Bairro:</strong> {{ perfil.bairro }}<br>
                    {{ perfil.logradouro }}, {{ perfil.numero }} 
                    {% if perfil.complemento %}- {{ perfil.complemento }}{% endif %}<br>
                    CEP: {{ perfil.cep }} - Rio de Janeiro, RJ
                </p>
            </div>

            <div class="checkout-card border-0">
                <h5 class="mb-4">üõç Resumo dos Itens</h5>

                <div class="table-responsive">
                    <table class="table checkout-table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">Produto</th>
                                <th scope="col" class="text-center">Tamanho</th>
                                <th scope="col" class="text-center">Cor</th>
                                <th scope="col" class="text-center">Quantidade</th>
                                <th scope="col" class="text-end">Pre√ßo</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in itens %}
                            <tr>
                                <td class="fw-bold text-dark">
                                {{ item.produto }}
                                </td>
                                <td class="text-center">
                                    <span class="badge bg-light text-dark border">{{ item.tamanho }}</span>
                                </td>
                                <td class="text-center small">
                                {{ item.cor|default:"-" }}
                                </td>
                                <td class="text-center">
                                    {{ item.quantidade }}
                                </td>
                                <td class="text-end fw-bold">
                                    R$ {{ item.subtotal }}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="checkout-card checkout-resumo border-0">
                <h5 class="mb-4">Resumo do Pedido</h5>
                
                <div class="d-flex justify-content-between mb-2">
                    <span class="text-muted">Produtos:</span>
                    <span>R$ {{ total_produtos }}</span>
                </div>

                <div class="d-flex justify-content-between mb-2">
                    <span class="text-muted">Frete ({{ perfil.bairro }}):</span>
                    <span class="text-success">R$ {{ frete }}</span>
                </div>

                <hr class="my-3">

                <div class="d-flex justify-content-between mb-4">
                    <span class="fw-bold fs-5">Total:</span>
                    <span class="fw-bold fs-5 text-dark">
                        R$ {{ total_geral }}
                    </span>
                </div>

                <a href="{{ link_pagamento }}" class="btn btn-pagar w-100 mb-3 py-3 text-uppercase fw-bold">
                    Confirmar e Pagar
                </a>

                <a href="{% url 'index' %}" class="btn btn-continuar w-100 mb-3 py-3 text-uppercase fw-bold">
                    Continuar Comprando
                </a>

                <div class="text-center mt-4 pt-3 border-top">
                    <div class="mb-2">
                        <img src="https://img.icons8.com/color/48/000000/visa.png" width="30">
                        <img src="https://img.icons8.com/color/48/000000/mastercard.png" width="30">
                        <img src="https://img.icons8.com/color/48/000000/pix.png" width="30">
                    </div>
                    <p class="text-muted" style="font-size: 0.75rem;">
                        Pagamento via Mercado Pago
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="bg-white py-5 border-top">
    <div class="container text-center">
        <h5 class="fw-bold">Vest Lavichy</h5>
        <p class="text-muted small">Moda feminina inspirada em eleg√¢ncia, estilo e sofistica√ß√£o</p>
        <a href="https://wa.me/5521977595943" target="_blank"><button class="btn-icon"><img src="{% static 'img/icones_categorias/iconZap.jpg' %}" alt="Logo" style="max-height: 45px;"></button></a>
        <a href="https://www.instagram.com/vest_lavichy" target="_blank"><button class="btn-icon"><img src="{% static 'img/icones_categorias/iconInsta.jpg' %}" alt="Logo" style="max-height: 45px;"></button></a>
        <p class="mt-4 mb-0 text-muted" style="font-size: 0.8rem;">¬© 2026 Vest Lavichy ‚Ä¢ Todos os direitos reservados</p>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>